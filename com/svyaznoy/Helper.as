package com.svyaznoy {	import com.flashgangsta.utils.PopupsController;	import flash.geom.Rectangle;	import flash.system.ApplicationDomain;	import flash.system.LoaderContext;	import flash.system.SecurityDomain;	import flash.utils.Dictionary;	import vk.APIConnection;	/**	 * ...	 * @author Sergey Krivtsov (flashgangsta@gmail.com)	 */	public class Helper {		private static var instance:Helper;				private var _loaderContext:LoaderContext = null; 		private var _isDebug:Boolean = true;		private var _vkAPI:APIConnection;		private var _flashvars:Object;		private var _userData:UserData;		private var _newsDatasByID:Dictionary = new Dictionary();		private var _screenRectangle:Rectangle;		private var _isEmployeeMode:Boolean = false;		private var _settingsData:SettingsData;				/**		 * 		 */				public function Helper() {			if ( !instance ) {				instance = this;			} else {				throw new Error( "Helper has singletone, use Helper.getInstance()" );			}		}				/**		 * 		 * @return		 */				public static function getInstance():Helper {			if ( !instance ) instance = new Helper();			return instance;		}				/**		 * 		 * @param	parameters		 */				public function setFlashvars( parameters:Object ):void {			_flashvars = parameters;			trace( "FLASHVARS:" );			for ( var p in _flashvars ) {				trace( p + "=" + _flashvars[ p ] );			}		}				/**		 * 		 */				public function createVkAPI():void {			_vkAPI = new APIConnection( _flashvars );		}				/**		 * 		 */				public function get loaderContext():LoaderContext {			return _loaderContext;		}				/**		 * 		 */				public function get isDebug():Boolean {			return _isDebug;		}				public function set isDebug( value:Boolean ):void {			_isDebug = value;			_loaderContext = isDebug ? null : new LoaderContext( true, ApplicationDomain.currentDomain, SecurityDomain.currentDomain );		}				/**		 * 		 */				public function get vkAPI():APIConnection {			return _vkAPI;		}				/**		 * 		 */				public function get isEmployeeMode():Boolean {			return _isEmployeeMode;		}				public function set isEmployeeMode(value:Boolean):void {			_isEmployeeMode = value;		}				/**		 * 		 * @return		 */				public function getUserID():int {			return isDebug ? 7010535 : _flashvars.viewer_id;		}				/**		 * 		 */				public function getAuthKey():String {			return isDebug ? "a2950141ba34e2f0a07bd9299bd55209" : _flashvars.auth_key;		}				/**		 * 		 * @return		 */				public function getAppID():int {			return _flashvars.api_id;		}				/**		 * 		 * @param	object		 */				public function setUserData( data:Object ):void {			_userData = new UserData( data );		}				/**		 * 		 * @return		 */				public function getUserData():UserData {			if ( !_userData && isDebug ) setUserData( JSON.parse('{"data":{"id":"9","username":"20369075","email":"20369075@vk.com","created_at":"2013-08-27 08:42:23","updated_at":"2013-09-02 14:27:01","intro":"1","employee":{"id":"9","user_id":"9","barcode":"27836514","first_name":"\u0410\u0439\u044f","middle_name":"\u041e\u0432\u0430\u043a\u043e\u0432\u043d\u0430","last_name":"\u0421\u0430\u0440\u0438\u043a\u044f\u043d","email":"cms.rnd.0095@maxus.ru","status":"1","created_at":"2013-08-25 08:14:40","updated_at":"2013-09-05 00:59:07","rating":"53","full_title":"\u0421\u0430\u0440\u0438\u043a\u044f\u043d \u0410\u0439\u044f \u041e\u0432\u0430\u043a\u043e\u0432\u043d\u0430"}}}') );			return _userData;		}				/**		 * 		 * @param	id		 */				public function getNewsDataByID( id:int ):Object {			return _newsDatasByID[ id ];		}				/**		 * 		 * @param	data		 */				public function setNewsData( data:Object ):void {			_newsDatasByID[ data.id ] = data;		}				/**		 * 		 * @param	x		 * @param	y		 * @param	width		 * @param	height		 */				public function setScreenRectangle( x:Number, y:Number, width:Number, height:Number ):void {			_screenRectangle = new Rectangle( x, y, width, height );		}				/**		 * 		 * @return		 */				public function getScreenRectangle():Rectangle {			return _screenRectangle;		}				/**		 * 		 * @return		 */				public function getSettings():SettingsData {			return _settingsData;		}				/**		 * 		 * @param	data		 */				public function setSettings( data:Object ):void {			_settingsData = new SettingsData( data );		}				public function getInviterID():int {			return _flashvars ? _flashvars.user_id : 0;		}				/**		 * 		 * @return		 */				public function getAppURL():String {			return "http://vk.com/app" + Helper.getInstance().getAppID();		}			}}