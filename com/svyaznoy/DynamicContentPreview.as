package com.svyaznoy {	import com.flashgangsta.ui.Scrollbar;	import com.flashgangsta.utils.Queue;	import com.svyaznoy.events.DynamicItemEvent;	import flash.display.MovieClip;	import flash.display.Sprite;	import flash.display.StageAlign;	import flash.display.StageScaleMode;	import flash.events.Event;	import flash.external.ExternalInterface;	import flash.display.DisplayObject;		/**	 * ...	 * @author Sergey Krivtsov (flashgangsta@gmail.com)	 */	public class DynamicContentPreview extends Sprite {				private var viewer:DynamicContentViewer = new DynamicContentViewer();		private var container:MovieClip = new MovieClip();		private var scrollbarView:ScrollbarView;		private var scrollMask:Sprite = new Sprite();		private var queue:Queue;				public function DynamicContentPreview() {			scrollMask = getChildByName( "mask_mc" ) as Sprite;						scrollbarView = getChildByName( "scrollbarView_mc" ) as ScrollbarView;			scrollbarView.visible = false;						viewer.width = 515;			viewer.addEventListener( DynamicItemEvent.SIZE_CHANGED, onSizeChanged );						container.mask = scrollMask;												addChild( container );			container.addChild( viewer );						addEventListener( Event.ADDED_TO_STAGE, onAddedToStage );			ExternalInterface.addCallback( "setContent", setContent );						var t:String = <![CDATA[**С 22 по 24 июля 2013 состоялась вторая  поездка в рамках проекта «Энергия Связного».**Победители мотивации «Энергия Связного» в направлении «СпецЭкспедиции. НПФ» за май и победители  конкурса для МПФП «5 экспедиций» по итогам мая  отправились   за Полярный круг, в край дикой природы и удивительных фьордов – в Северную Норвегию!Целью Экспедиции стало покорение самой северной точки **Европы** – скалистого мыса Нордкап! Высота над уровнем моря – 300 метров, а дальше – только воды Северного Ледовитого океана.Участники Экспедиции участвовали в ловле настоящего снежного краба, и купались в ледяных водах Баренцева моря,    любовались полуночным солнцем и причудливыми формами горных вершин, познакомились с коренными обитателями Норвегии – древними саамами.Особенностью Экспедиции стало прохождение  тренинга «Найди свою энергию», где участники тренировались ставить новые цели и находить новые источники энергии для их достижения, учились достигать внутреннюю   гармонию  и позитивное настроение!**Экспедиция окончена, но самые интересные приключения еще впереди. Сезон «Энергии Связного» только начался и вас ждут еще более захватывающие авантюры и открытия.Энергия Связного наступает – будь в теме!**sdasd**s**s]]>;						//setContent( t );					}				private function onSizeChanged( event:DynamicItemEvent ):void {			var lastY:int = 0;			var margin:int = 0;			for ( var i:int = 0; i < viewer.numChildren; i++ ) {				var child:DisplayObject = viewer.getChildAt( i );				child.y = lastY;				lastY = lastY + child.height + margin;			}			Scrollbar.update( scrollbarView.getCarret() );			scrollbarView.visible = Scrollbar.isNeeded( scrollbarView.getCarret() );		}				private function setContent( data:String ):void {			if ( !stage ) {				queue = new Queue();				queue.add( setContent, data );				return;			}			viewer.clear();			Scrollbar.reset( scrollbarView.getCarret() );			viewer.displayData( data );					}				private function onAddedToStage( event:Event ):void {			removeEventListener( Event.ADDED_TO_STAGE, onAddedToStage );						stage.align = StageAlign.TOP_LEFT;			stage.scaleMode = StageScaleMode.NO_SCALE;						Scrollbar.setVertical( container, scrollMask.getBounds( this ), scrollbarView.getUpBtn(), scrollbarView.getDownBtn(), scrollbarView.getCarret(), scrollbarView.getBounds( scrollbarView ), stage );						if ( queue ) {				queue.applyAll();				queue = null;			}		}			}}